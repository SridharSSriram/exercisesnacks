var workout_database = [
		{
			workoutName: "Sunday School Mobility",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body, Hips, Spine, Legs, Core",
			time: 8,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/p/CJCNTW5gfuu/?igshid=1ata3bxhjzk22",
			backend_ID:1
		},
		{
			workoutName: "9 Jump Rope Variations",
			workoutType: "Workout Variations, Conditioning",
			targetedBodyPart: "Full Body, Core",
			time: "-",
			equipment: "Jump Rope",
			insta_link: "https://www.instagram.com/p/CI8y9pFA1UY/?igshid=gxesdcprn4e5",
			backend_ID:2
		},
		{
			workoutName: "Blood Booster",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body, Core",
			time: 5,
			equipment: "N/A",
			insta_link: "https://www.instagram.com/tv/CI30yVfAT-M/?igshid=kg1hk4a8j4me",
			backend_ID:3
		},
		{
			workoutName: "Spine, Neck, & Shoulders",
			workoutType: "Mobility",
			targetedBodyPart: "Upper Body, Spine, Hips, Neck",
			time: 8,
			equipment: "Chair",
			insta_link: "https://www.instagram.com/tv/CIvv3JJg-uG/?igshid=1072tal6tjb7n",
			backend_ID:4
		},
		{
			workoutName: '"More Fun with Bands" Resistance Bands Circuit',
			workoutType: "Core, Strength",
			targetedBodyPart: "Core, Legs, Arms",
			time: 15,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/p/CHiYaFUAlvQ/?igshid=12l3e33g6dfqc",
			backend_ID:5
		},
		{
			workoutName: "13 Minutes of Fresh",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body, Spine, Wrist, Ankles",
			time: 13,
			equipment: "Chair",
			insta_link: "https://www.instagram.com/tv/CHYEHE7AFY-/?igshid=6s263pq67pko",
			backend_ID:6
		},
		{
			workoutName: 'Glute Band Variations',
			workoutType: "Core, Strength",
			targetedBodyPart: "Core, Legs, Lower Body",
			time: "-",
			equipment: "Mat",
			insta_link: "https://www.instagram.com/p/CG8huFngD8j/?igshid=1w0htl1yzf4zo",
			backend_ID:7
		},
		{
			workoutName: "Neck & Spine Circuit",
			workoutType: "Mobility",
			targetedBodyPart: "Spine, Neck, Back",
			time: 8,
			equipment: "Chair",
			insta_link: "https://www.instagram.com/tv/CGfSbnYgQSF/?igshid=1biuxdf488zbj",
			backend_ID:8
		},
		{
			workoutName: "Conditioning, Core, & Control",
			workoutType: "Conditioning, Core",
			targetedBodyPart: "Full Body, Core",
			time: 15,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/tv/CGakuR5gLM4/?igshid=c486tt2m5a58",
			backend_ID:9
		},
		{
			workoutName: "Power Snack",
			workoutType: "Conditioning, Strength",
			targetedBodyPart: "Full Body",
			time: 15,
			equipment: "N/A",
			insta_link: "https://www.instagram.com/p/CF2jIMcAFB_/?igshid=zuwt8uh70eln",
			backend_ID:10
		},
		{
			// come back to this
			workoutName: "Movement Mash-Up",
			workoutType: "Conditioning, Strength",
			targetedBodyPart: "Full Body",
			time: 15,
			equipment: "N/A",
			insta_link: "https://www.instagram.com/p/CF2jIMcAFB_/?igshid=zuwt8uh70eln",
			backend_ID:11
		},
		{
			workoutName: "Nervous System Spinal Sequence",
			workoutType: "Mobility",
			targetedBodyPart: "Spine, Shoulders",
			time: 5,
			equipment: "Mat",
			insta_link: "ttps://www.instagram.com/p/CEzF56kgsHb/?igshid=12nb5sn4kit4c",
			backend_ID:12
		},
		{
			workoutName: "Speed Workout Warm-Up",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body, Hips, Upper Body",
			time: 18,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/tv/CEhosExAvqC/?igshid=14iudsav311mv",
			backend_ID:13
		},
		{
			workoutName: "Standing Runners Warm-up",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body, Spine, Legs, Hips",
			time: 10,
			equipment: "N/A",
			insta_link: "https://www.instagram.com/p/CDmJTmaA36B/?igshid=a7y44dewqdsz",
			backend_ID:14
		},
		{
			workoutName: "Digestion & Energy Circuit",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body",
			time: 10,
			equipment: "N/A",
			insta_link: "https://www.instagram.com/tv/CDjzyZ5ALYM/?igshid=1l5osea2611fl",
			backend_ID:15
		},
		{
			workoutName: "Morning Mobility",
			workoutType: "Mobility",
			targetedBodyPart: "Full Body, Upper Body",
			time: 15,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/tv/CCLvx2GAWAt/?igshid=m6gf662v1ify",
			backend_ID:16
		},
		{
			workoutName: "Mobility Routine",
			workoutType: "Mobility",
			targetedBodyPart: "Lower Body, Spine, Hips",
			time: 8,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/p/CADZAiVg3l7/?igshid=754jpfqyy9hr",
			backend_ID:17
		},
		{
			workoutName: "Kirsty Godso x OchoSystem Stability Series",
			workoutType: "Mobility",
			targetedBodyPart: "Hips, Core, Upper Body",
			time: 10,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/p/B_fsfYagdDB/?igshid=y2jagsx84dd7",
			backend_ID:18
		},
		{
			workoutName: "Naomi Campbell x OchoSystem Stability Workout",
			workoutType: "Mobility",
			targetedBodyPart: "Lower Body, Core",
			time: 5,
			equipment: "N/A",
			insta_link: "https://www.instagram.com/p/B-iNIfEAVyP/?igshid=1q3mxj612d3vs",
			backend_ID:19
		},

		{
			workoutName: "Mobility & Wind-down Drills",
			workoutType: "Mobility",
			targetedBodyPart: "Spine, Hips, Legs",
			time: 8,
			equipment: "Chair, Mat",
			insta_link: "https://www.instagram.com/p/B-Iw2TCAouc/?igshid=151p3scnvdaoo",
			backend_ID:20
		},
		{
			workoutName: "Naomi Campbell x OchoSystem Activation/Joints",
			workoutType: "Mobility",
			targetedBodyPart: "Legs, Hips, Lower Body",
			time: 5,
			equipment: "Mat",
			insta_link: "https://www.instagram.com/p/B9-QjdQgjZE/?igshid=134n0ua1tian1",
			backend_ID:21
		}

	];


// var database_test = CSVToArray("data/exercisesnacks_workout_archive.csv");
// console.log(database_test);

var database_test_csv_array = $.csv.toObjects("assets/data/addresses.csv");

console.log("this is the database: " + database_test_csv_array);
console.log("array length: " + database_test_csv_array.length);

// var fr=new FileReader();
// var fr_test = fr.readAsText("assets/data/addresses.csv");
// console.log(fr_test);

// function readSingleFile(e) {
//   var file = e.target.files[0];
//   if (!file) {
//     return;
//   }
//   var reader = new FileReader();
//   reader.onload = function(e) {
//     var contents = e.target.result;
//     displayContents(contents);
//   };
//   reader.readAsText(file);
// }

// function displayContents(contents) {
//   var element = document.getElementById('file-content');
//   element.textContent = contents;
// }

// document.getElementById('file-input').addEventListener('change', readSingleFile, false);
// var datatable = [];
// datatable.rows.add($.csv.toObjects("data/exercisesnacks_workout_archive .csv")).draw();
  
// console.log(database_test.prototype.length);



// CODE FOR DETECTING IF BODY PART ALIGNS WITH PREFERENCE

var LOWER_BODY = ["lower body", "hips", "ankles", "legs"];
var UPPER_BODY = ["upper body", "spine", "arms", "back", "neck", "wrists"];
var FULL_BODY = ["full body"];

var testing_tings = "Spine, Hips, Legs";

var spliced_tings = testing_tings.toLowerCase().split(", ");

spliced_tings.forEach(function(ting){
	if(LOWER_BODY.includes(ting)){
		console.log("lower body");
	}else if(UPPER_BODY.includes(ting)){
		console.log("upper body");
	} else if(FULL_BODY.includes(ting)){
		console.log("full body");
	}

})


function generate_HTML_card(workout_entry){
	var wrapper_div=document.createElement('div');
		wrapper_div.className="col-lg-4 col-md-7 col-sm-8 workoutcard";
		wrapper_div.id="workoutcard_"+workout_entry.backend_ID;
		console.log(wrapper_div.id);

	// console.log(workout_entry);
	var big_div = document.createElement('div');
		big_div.className= "single-services mt-30 wow fadeIn";
		// data-wow-duration="1s" data-wow-delay="0.2s"
		big_div.setAttribute("data-wow-duration","1s");
		big_div.setAttribute("data-wow-delay","0.2s");
	var smaller_div = document.createElement('div');
		smaller_div.className = "services-content mt-30";
	// big_div.appendChild(smaller_div);
	
	var heading = document.createElement("h4");
		heading.className="services-title";
		heading.innerHTML = workout_entry.workoutName;
		smaller_div.appendChild(heading);

	var body_part = document.createElement("p");
		body_part.className="text";
		body_part.innerHTML="<strong>Workout Type:</strong> "+workout_entry.workoutType;
		smaller_div.appendChild(body_part);

	var body_part = document.createElement("p");
		body_part.innerHTML="<strong>Body part:</strong> "+workout_entry.targetedBodyPart;
		smaller_div.appendChild(body_part);

	var duration = document.createElement("p");
		duration.className="workout_duration"
		duration.innerHTML = "<strong>Time:</strong> " + workout_entry.time +" min.";
		smaller_div.appendChild(duration);

	var equipment = document.createElement("p");
		equipment.innerHTML = "<strong>Equipment:</strong> " + workout_entry.equipment +"<br><br>";
		smaller_div.appendChild(equipment);

	var link = document.createElement("a");
		link.className="external_link";
		link.target="_blank";
		link.href=workout_entry.insta_link;
		link.innerHTML="link"
		smaller_div.appendChild(link);

	big_div.appendChild(smaller_div);
	wrapper_div.appendChild(big_div);
	return wrapper_div;

}

var card_container = document.getElementById("cardcontainer");
workout_database.forEach(function(workout_entry){
	card_container.appendChild(generate_HTML_card(workout_entry));
});


function toggleVisibility(passed_in_item){
	if (passed_in_item.style.display === "none") {
		passed_in_item.style.display = "block";
	} else {
		passed_in_item.style.display = "none";
	}
}


var value_array = [];
var article_list = document.querySelectorAll('.workoutcard');

function valueUpdate(totalItems){
	// console.log(totalItems);
	var value_entity = totalItems.value.toLowerCase();
	if(value_entity.includes(" ")){
		value_entity=value_entity.replace(" ","");
	}
	var workout_list = document.querySelectorAll('.workoutcard');
	switch (value_entity){
		case "fullbody":
			workout_list.forEach(function(workoutentry){
				if(!(workoutentry.innerHTML.toLowerCase().includes(FULL_BODY))){
					workoutentry.style.display = "none";
				}
				console.log("check this: " + workoutentry);
			})
		case "lowerbody":
			console.log("lowerbod");
		case "upperbody":
			console.log("yikies");
		case "min5":
			
			workout_database.forEach(function(workoutentry){
				if(workoutentry.time >5){
					// console.log("#workoutcard_"+workoutentry.backend_ID);
					var hide_this=document.getElementById("workoutcard_"+workoutentry.backend_ID);
					hide_this.style.display="none";
					
				}
			});
		case "under10min":
			
			workout_database.forEach(function(workoutentry){
				if(workoutentry.time >10){
					// console.log("#workoutcard_"+workoutentry.backend_ID);
					var hide_this=document.getElementById("workoutcard_"+workoutentry.backend_ID);
					hide_this.style.display="none";
					
				}
			});
		case "over10min":
			
			workout_database.forEach(function(workoutentry){
				if(workoutentry.time <10){
					// console.log("#workoutcard_"+workoutentry.backend_ID);
					var hide_this=document.getElementById("workoutcard_"+workoutentry.backend_ID);
					hide_this.style.display="none";
					
				}
			});
	}


	var showing_things = document.querySelectorAll('article.'+value_entity);
	// console.log(showing_things);

	var article_toggle = document.querySelectorAll('article');
	article_toggle.forEach(function(userItem){
		// console.log(userItem.className);
		if(!(userItem.className.includes(value_entity))){
			toggleVisibility(userItem);
		}
	})
	if(totalItems.checked){
		console.log("it's been checked");
		value_array.push(value_entity);	
		console.log(value_array);
		return;
	} else{
		console.log("it has NOT BEEN CHECKED");
		value_array.pop(value_entity);
		// showing_things.forEach(function(userItem) {
		// 	toggleVisibility(userItem);
			
		// });

	}
}

function filterResults(){
	value_array.forEach(function(userItem){
		console.log(userItem);
		var applicable_entities=document.querySelectorAll('.'+userItem);
	});
}

function CSVToArray( strData, strDelimiter ){
		// Check to see if the delimiter is defined. If not,
		// then default to comma.
		strDelimiter = (strDelimiter || ",");

		// Create a regular expression to parse the CSV values.
		var objPattern = new RegExp(
			(
				// Delimiters.
				"(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +

				// Quoted fields.
				"(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +

				// Standard fields.
				"([^\"\\" + strDelimiter + "\\r\\n]*))"
			),
			"gi"
			);


		// Create an array to hold our data. Give the array
		// a default empty first row.
		var arrData = [[]];

		// Create an array to hold our individual pattern
		// matching groups.
		var arrMatches = null;


		// Keep looping over the regular expression matches
		// until we can no longer find a match.
		while (arrMatches = objPattern.exec( strData )){

			// Get the delimiter that was found.
			var strMatchedDelimiter = arrMatches[ 1 ];

			// Check to see if the given delimiter has a length
			// (is not the start of string) and if it matches
			// field delimiter. If id does not, then we know
			// that this delimiter is a row delimiter.
			if (
				strMatchedDelimiter.length &&
				(strMatchedDelimiter != strDelimiter)
				){

				// Since we have reached a new row of data,
				// add an empty row to our data array.
				arrData.push( [] );

			}


			// Now that we have our delimiter out of the way,
			// let's check to see which kind of value we
			// captured (quoted or unquoted).
			if (arrMatches[ 2 ]){

				// We found a quoted value. When we capture
				// this value, unescape any double quotes.
				var strMatchedValue = arrMatches[ 2 ].replace(
					new RegExp( "\"\"", "g" ),
					"\""
					);

			} else {

				// We found a non-quoted value.
				var strMatchedValue = arrMatches[ 3 ];

			}


			// Now that we have our value string, let's add
			// it to the data array.
			arrData[ arrData.length - 1 ].push( strMatchedValue );
		}

		// Return the parsed data.
		return( arrData );
	}

function parseCSV(str) {
    var arr = [];
    var quote = false;  // 'true' means we're inside a quoted field

    // Iterate over each character, keep track of current row and column (of the returned array)
    for (var row = 0, col = 0, c = 0; c < str.length; c++) {
        var cc = str[c], nc = str[c+1];        // Current character, next character
        arr[row] = arr[row] || [];             // Create a new row if necessary
        arr[row][col] = arr[row][col] || '';   // Create a new column (start with empty string) if necessary

        // If the current character is a quotation mark, and we're inside a
        // quoted field, and the next character is also a quotation mark,
        // add a quotation mark to the current column and skip the next character
        if (cc == '"' && quote && nc == '"') { arr[row][col] += cc; ++c; continue; }

        // If it's just one quotation mark, begin/end quoted field
        if (cc == '"') { quote = !quote; continue; }

        // If it's a comma and we're not in a quoted field, move on to the next column
        if (cc == ',' && !quote) { ++col; continue; }

        // If it's a newline (CRLF) and we're not in a quoted field, skip the next character
        // and move on to the next row and move to column 0 of that new row
        if (cc == '\r' && nc == '\n' && !quote) { ++row; col = 0; ++c; continue; }

        // If it's a newline (LF or CR) and we're not in a quoted field,
        // move on to the next row and move to column 0 of that new row
        if (cc == '\n' && !quote) { ++row; col = 0; continue; }
        if (cc == '\r' && !quote) { ++row; col = 0; continue; }

        // Otherwise, append the current character to the current column
        arr[row][col] += cc;
    }
    return arr;
}